#!/bin/sh
# Malvolio CLI wrapper script

# Find the script directory
SCRIPT="$0"
while [ -L "$SCRIPT" ]; do
  SCRIPT_DIR=$(cd "$(dirname "$SCRIPT")" && pwd)
  SCRIPT=$(readlink "$SCRIPT")
  [[ $SCRIPT != /* ]] && SCRIPT="$SCRIPT_DIR/$SCRIPT"
done
PROJECT_DIR=$(cd "$(dirname "$SCRIPT")/.." && pwd)

# Run with SBCL
exec sbcl --noinform --non-interactive \
    --load "$PROJECT_DIR/.qlot/setup.lisp" \
    --eval "(asdf:load-system :malvolio)" \
    --eval "(malvolio:main)" -- "$@"
